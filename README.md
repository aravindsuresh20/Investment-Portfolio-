# Investment-Portfolio-
This project provides a comprehensive web-based system for optimizing investment portfolios, performing in-depth exploratory data analysis (EDA) on stock data, and maintaining detailed logs of optimization results. It integrates a Flask web application with a machine learning model for predicting future stock returns, aiming to empower users with data-driven insights to construct and manage investment portfolios effectively.

### Features

* **Data-Driven Portfolio Optimization**: Calculates optimal weights for a user-selected basket of stocks, aiming to achieve an efficient balance between expected return and risk based on historical data.
* **Actionable Exploratory Data Analysis (EDA)**: Automatically performs detailed EDA on the chosen stock data, including an overview of columns, dataset shape, identification of missing values, summary statistics, and a correlation matrix. This valuable analysis is saved to `eda_output.txt` for easy reference.
* **Predictive Investment Insights**: Incorporates a pre-trained Linear Regression model designed to predict future stock returns based on past performance. This predictive capability can be leveraged for developing more sophisticated, forward-looking portfolio strategies.
* **Transparent Results Logging & Audit Trail**: All portfolio optimization results, including selected tickers, calculated weights, expected return, risk, and a timestamp, are automatically logged to an Excel file (`portfolio_results.xlsx`). This creates a robust audit trail for performance monitoring and detailed historical analysis.
* **Convenient Report Downloads**: Allows users to easily download the `portfolio_results.xlsx` file directly from the web application for offline analysis or record-keeping.
* **Intuitive Web Interface**: Features a user-friendly Flask application that facilitates stock selection, initiates the analysis process, and clearly displays the optimization outcomes.

### Requirements

The application and model training process rely on the following Python libraries:

* **Python 3.x**
* **Flask**: For building the interactive web application.
* **Pandas**: For efficient data manipulation, reading CSV/Excel files, and performing EDA.
* **scikit-learn**: For machine learning functionalities, specifically `LinearRegression` for return prediction and `train_test_split` for data partitioning.
* **joblib**: For robust saving and loading of the trained machine learning model.
* **openpyxl**: Implicitly required by Pandas for handling `.xlsx` (Excel) files during results logging.
* **`portfolio_optimizer` module**: An external Python module containing `get_stock_data` and `optimize_portfolio` functions, which are critical for the web application's core portfolio optimization functionality. (This module is assumed to be present in your environment).

You can install these dependencies using `pip` from a `requirements.txt` file (which you would create).

### Installation and Setup

1.  **Project Structure:**
    ```
    /your-project-directory
    │── /data
    │   └── portfolio_data.csv           # Your stock dataset
    │── /model
    │   └── portfolio_model.pkl          # Trained machine learning model
    │── /portfolio_results               # Directory for optimization results
    │   └── portfolio_results.xlsx
    │── /templates                       # HTML templates for the web interface
    │   ├── startup.html                 # Initial landing page
    │   ├── index.html                   # Stock selection and input page
    │   └── result.html                  # Displays optimization results
    │── eda_output.txt                   # EDA summary generated by app.py
    │── app.py                           # Flask web application
    │── train_model.py                   # Script for training the predictive model
    │── portfolio_optimizer.py           # External module (assumed to be present)
    │── requirements.txt                 # Python dependencies (create this file)
    │── README.md                        # Project documentation (this file)
    ```

2.  **Place your dataset**: Ensure your stock data file, named `portfolio_data.csv`, is located within the `data/` directory relative to your project root.

3.  **Ensure `portfolio_optimizer.py` is present**: Make sure the `portfolio_optimizer.py` file (containing `get_stock_data` and `optimize_portfolio` functions) is in the same directory as `app.py`, as it is imported and utilized by the Flask application.

4.  **Create `requirements.txt`**: Create a file named `requirements.txt` in your project root with the following content:
    ```
    Flask
    pandas
    scikit-learn
    joblib
    openpyxl
    ```

5.  **Set up a virtual environment (recommended):**
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows: venv\Scripts\activate
    ```

6.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

7.  **Train the Predictive Model (Optional but Recommended)**:
    Run the `train_model.py` script **once** to train the `LinearRegression` model that predicts stock returns and save it as `model/portfolio_model.pkl`. This model provides a foundational component for more advanced portfolio strategies.
    ```bash
    python train_model.py
    ```

8.  **Run the Flask Application**:
    ```bash
    python app.py
    ```
    This will start the Flask development server.

9.  **Access the Application**: Open your web browser and navigate to `http://127.0.0.1:5000`.

### Project Structure (Detailed)

* **`/data/portfolio_data.csv`**: The foundational dataset containing historical stock prices. It is expected to have columns such as 'date', 'Name' (representing stock ticker/name), and 'close' (for closing price).
* **`/model/portfolio_model.pkl`**: The serialized (trained) `LinearRegression` model generated by `train_model.py`. This model is designed to predict daily returns.
* **`/portfolio_results/`**: This directory is automatically created by the `app.py` script to store the outcomes of portfolio optimization sessions.
    * **`portfolio_results.xlsx`**: An Excel file that serves as a persistent log of all generated portfolio optimization results.
* **`/templates/`**: Contains the HTML templates that define the structure and appearance of the web interface:
    * **`startup.html`**: The initial landing page displayed when the application is accessed.
    * **`index.html`**: The main page where users can select stocks for portfolio analysis and initiate the optimization process.
    * **`result.html`**: Displays the detailed outcomes of the portfolio optimization, including the expected return, risk, and the optimal weight allocated to each selected asset.
* **`eda_output.txt`**: A text file generated by `app.py` that provides a comprehensive summary of the exploratory data analysis performed on the selected stock data during each analysis session.
* **`app.py`**: The core Flask application script. It is responsible for:
    * Loading historical stock data and identifying available stocks.
    * Defining and managing web routes for the startup page (`/`), the home/analysis page (`/home`), and the results download (`/download`).
    * Processing user inputs for stock selection.
    * Calculating stock returns from the fetched data.
    * Performing EDA on the selected data and saving the report.
    * Invoking the `optimize_portfolio` function from the `portfolio_optimizer` module to perform the core optimization.
    * Saving the generated optimization results to `portfolio_results.xlsx`.
* **`train_model.py`**: A separate script dedicated to the machine learning aspect of the project. It handles:
    * Loading and preprocessing the `portfolio_data.csv`.
    * Training a `LinearRegression` model to predict daily stock returns.
    * Saving the trained model as `model/portfolio_model.pkl`.
* **`portfolio_optimizer.py`**: An external Python file (assumed to be provided by the user) containing essential functions like `get_stock_data` for fetching stock data and `optimize_portfolio` for executing the portfolio optimization algorithms.
* **`requirements.txt`**: Lists all necessary Python packages required for the project to run successfully.

### Usage

1.  **Prepare Data and Predictive Model**: Before launching the web application, ensure your `data/portfolio_data.csv` file is correctly placed. It is highly recommended to first run `python train_model.py` to generate the `model/portfolio_model.pkl` for predictive capabilities.
2.  **Start the Application**: From your terminal, execute `python app.py` to launch the Flask web server.
3.  **Access the Web Interface**: Open your web browser and navigate to `http://127.0.0.1:5000` to access the application's startup page.
4.  **Select Investment Assets**: Proceed to the main analysis page (typically `/home`). Here, you can choose the specific stocks you wish to include in your investment portfolio from the provided list.
5.  **Optimize Your Portfolio**: After selecting your desired stocks, submit your choices. The application will then perform the portfolio optimization, displaying the calculated expected return, the associated risk, and the optimal weight distribution for each chosen asset.
6.  **Review Analytical Insights**: For a deeper understanding of the underlying stock data, examine the `eda_output.txt` file (located in your project root). This report provides a detailed exploratory data analysis of the stocks you selected for optimization.
7.  **Download Historical Records**: To maintain a record of your optimization sessions, you can download the `portfolio_results.xlsx` file. This log provides a valuable history of your portfolio decisions and their calculated outcomes.

